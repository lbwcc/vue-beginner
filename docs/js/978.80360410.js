"use strict";(self["webpackChunkvue_beginner"]=self["webpackChunkvue_beginner"]||[]).push([[978],{4978:function(t,e,r){r.r(e),r.d(e,{default:function(){return k}});var s=r(641),i=r(33);const n={class:"tetris-container"},h={class:"tetris-info"},a={class:"tetris-board"};function u(t,e,r,u,o,l){return(0,s.uX)(),(0,s.CE)("div",n,[(0,s.Lk)("div",h,[(0,s.Lk)("div",null,"分数："+(0,i.v_)(o.score),1),(0,s.Lk)("div",null,"状态："+(0,i.v_)(o.isGameOver?"游戏结束":o.isPaused?"暂停":"进行中"),1),!o.isStarted||o.isGameOver?((0,s.uX)(),(0,s.CE)("button",{key:0,onClick:e[0]||(e[0]=(...t)=>l.startGame&&l.startGame(...t))},"开始")):(0,s.Q3)("",!0),!o.isStarted||o.isPaused||o.isGameOver?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("button",{key:1,onClick:e[1]||(e[1]=(...t)=>l.pauseGame&&l.pauseGame(...t))},"暂停")),o.isPaused&&!o.isGameOver?((0,s.uX)(),(0,s.CE)("button",{key:2,onClick:e[2]||(e[2]=(...t)=>l.resumeGame&&l.resumeGame(...t))},"继续")):(0,s.Q3)("",!0),o.isStarted?((0,s.uX)(),(0,s.CE)("button",{key:3,onClick:e[3]||(e[3]=(...t)=>l.restartGame&&l.restartGame(...t))},"重开")):(0,s.Q3)("",!0)]),(0,s.Lk)("div",a,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.displayBoard,((t,e)=>((0,s.uX)(),(0,s.CE)("div",{key:e,class:"tetris-row"},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(t,((t,e)=>((0,s.uX)(),(0,s.CE)("div",{key:e,class:"tetris-cell",style:(0,i.Tr)(t?{background:t,borderColor:t}:{})},null,4)))),128))])))),128))])])}const o=10,l=20,c=[[[0,0,0,0],[1,1,1,1],[0,0,0,0],[0,0,0,0]],[[1,0,0],[1,1,1],[0,0,0]],[[0,0,1],[1,1,1],[0,0,0]],[[1,1],[1,1]],[[0,1,1],[1,1,0],[0,0,0]],[[0,1,0],[1,1,1],[0,0,0]],[[1,1,0],[0,1,1],[0,0,0]]],d=["#B7AFA3","#A7A69D","#C1B7A3","#A3A7B7","#B7A3A7","#B7B3A3","#A3B7B3","#B7A3B3","#A3B3B7","#B3B7A3"];function m(){const t=c[Math.floor(Math.random()*c.length)];return t.map((t=>t.slice()))}var f={name:"Tetris",data(){return{board:[],current:null,currentX:0,currentY:0,currentColor:"",timer:null,interval:500,isStarted:!1,isPaused:!1,isGameOver:!1,score:0}},computed:{displayBoard(){let t=this.board.map((t=>t.slice()));if(this.current)for(let e=0;e<this.current.length;e++)for(let r=0;r<this.current[e].length;r++)if(this.current[e][r]){let s=this.currentX+r,i=this.currentY+e;i>=0&&i<t.length&&s>=0&&s<t[0].length&&(t[i][s]=this.currentColor||"#B7AFA3")}return t}},mounted(){window.addEventListener("keydown",this.handleKey),this.resetBoard();const t=this.$el.querySelector(".tetris-board");let e=0,r=0,s=!1;t&&(t.addEventListener("touchstart",(t=>{1===t.touches.length&&(e=t.touches[0].clientX,r=t.touches[0].clientY,s=!1)})),t.addEventListener("touchmove",(t=>{if(this.isStarted&&!this.isPaused&&!this.isGameOver&&1===t.touches.length){const i=t.touches[0].clientX-e,n=t.touches[0].clientY-r;Math.abs(i)>30&&!s?(i>0?this.handleKey({key:"ArrowRight"}):this.handleKey({key:"ArrowLeft"}),s=!0):Math.abs(n)>30&&!s&&n>0&&(this.handleKey({key:"ArrowDown"}),s=!0)}})),t.addEventListener("touchend",(t=>{s||this.handleKey({key:"ArrowUp"})})))},beforeUnmount(){window.removeEventListener("keydown",this.handleKey),this.stopTimer()},methods:{resetBoard(){this.board=Array.from({length:l},(()=>Array(o).fill(null)))},startGame(){this.resetBoard(),this.score=0,this.isStarted=!0,this.isPaused=!1,this.isGameOver=!1,this.spawn(),this.startTimer()},pauseGame(){this.isPaused=!0,this.stopTimer()},resumeGame(){this.isPaused=!1,this.startTimer()},restartGame(){this.startGame()},startTimer(){this.stopTimer(),this.timer=setInterval(this.tick,this.interval)},stopTimer(){this.timer&&(clearInterval(this.timer),this.timer=null)},spawn(){this.current=m(),this.currentY=0,this.currentX=Math.floor((o-this.current[0].length)/2),this.currentColor=d[Math.floor(Math.random()*d.length)],this.isValid(this.currentX,this.currentY,this.current)||(this.isGameOver=!0,this.stopTimer())},merge(){for(let t=0;t<this.current.length;t++)for(let e=0;e<this.current[t].length;e++)this.current[t][e]&&(this.board[this.currentY+t][this.currentX+e]=this.currentColor)},isValid(t,e,r){for(let s=0;s<r.length;s++)for(let i=0;i<r[s].length;i++)if(r[s][i]){let r=t+i,n=e+s;if(r<0||r>=o||n<0||n>=l)return!1;if(this.board[n][r])return!1}return!0},tick(){this.isPaused||this.isGameOver||(this.isValid(this.currentX,this.currentY+1,this.current)?this.currentY++:(this.merge(),this.clearLines(),this.spawn()))},clearLines(){let t=0;for(let e=l-1;e>=0;e--)this.board[e].every((t=>t))&&(this.board.splice(e,1),this.board.unshift(Array(o).fill(null)),t++,e++);t>0&&(this.score+=100*t)},handleKey(t){if(this.isStarted&&!this.isPaused&&!this.isGameOver&&this.current)if(["ArrowLeft","ArrowRight","ArrowDown","ArrowUp"," "].includes(t.key)&&(t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation()),"ArrowLeft"===t.key)this.isValid(this.currentX-1,this.currentY,this.current)&&this.currentX--;else if("ArrowRight"===t.key)this.isValid(this.currentX+1,this.currentY,this.current)&&this.currentX++;else if("ArrowDown"===t.key)this.isValid(this.currentX,this.currentY+1,this.current)&&this.currentY++;else if("ArrowUp"===t.key){const t=this.rotate(this.current);this.isValid(this.currentX,this.currentY,t)&&(this.current=t)}else if(" "===t.key){while(this.isValid(this.currentX,this.currentY+1,this.current))this.currentY++;this.tick()}},rotate(t){const e=t.length;let r=Array.from({length:e},(()=>Array(e).fill(0)));for(let s=0;s<e;s++)for(let i=0;i<e;i++)r[i][e-1-s]=t[s][i];return r}}},v=r(6262);const y=(0,v.A)(f,[["render",u],["__scopeId","data-v-3de9053b"]]);var k=y}}]);
//# sourceMappingURL=978.80360410.js.map