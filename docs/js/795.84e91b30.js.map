{"version":3,"file":"js/795.84e91b30.js","mappings":"oKAAA,IAAIA,EAAS,WAAkB,IAAIC,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAGE,EAAOJ,EAAIG,MAAME,YAAY,OAAOH,EAAG,MAAM,CAACI,YAAY,cAAc,CAACJ,EAAG,SAAS,CAACK,IAAI,SAASC,MAAOJ,EAAkB,YAAEK,MAAM,CAAC,MAAQL,EAAOM,YAAY,OAASN,EAAOO,gBAAiBP,EAAe,SAAEF,EAAG,MAAM,CAACI,YAAY,aAAa,CAACN,EAAIY,GAAG,YAAYZ,EAAIa,GAAGT,EAAOU,OAAO,KAAKZ,EAAG,SAAS,CAACa,GAAG,CAAC,MAAQX,EAAOY,UAAU,CAAChB,EAAIY,GAAG,YAAYZ,EAAIiB,MACja,EACIC,EAAkB,G,qCCYtB,MAAMC,EAAW,IACXC,EAAW,GACXC,EAAOF,EAAWC,EAClBE,EAAOH,EAAWC,EAElBG,GAAS,IAAAhB,KAAI,MACbiB,GAAQ,IAAAjB,KAAI,CAChB,CAAEkB,EAAG,EAAGC,EAAG,KAEPC,GAAY,IAAApB,KAAI,SAChBqB,GAAO,IAAArB,KAAI,CAAEkB,EAAG,GAAIC,EAAG,KACvBG,GAAW,IAAAtB,MAAI,GACfO,GAAQ,IAAAP,KAAI,GAClB,IAAIuB,EAAQ,KAGZ,MAAMpB,GAAc,IAAAH,KAAIY,GAClBR,GAAe,IAAAJ,KAAIY,GACnBY,GAAc,IAAAC,WAAS,KAAM,CACjCC,MAAO,OACPC,OAAQ,OACRC,SAAU,QACVC,UAAW,QACXC,QAAS,QACTC,YAAa,WAGf,SAASC,IAEP,MAAMC,EAAOC,KAAKC,IAAIC,OAAOC,WAAY,KACzClC,EAAYmC,MAAQL,EACpB7B,EAAakC,MAAQL,CACvB,CAEA,SAASM,IACP,MAAMC,EAAMxB,EAAOsB,MAAMG,WAAW,MACpCD,EAAIE,UAAU,EAAG,EAAGvC,EAAYmC,MAAOlC,EAAakC,OACpD,MAAMK,EAASxC,EAAYmC,MAAQxB,EAC7B8B,EAASxC,EAAakC,MAAQvB,EAEpCyB,EAAIK,UAAY,QAChB5B,EAAMqB,MAAMQ,SAAQC,IAClBP,EAAIQ,SAASD,EAAI7B,EAAIyB,EAAQI,EAAI5B,EAAIyB,EAAQD,EAAQC,EAAO,IAG9DJ,EAAIK,UAAY,MAChBL,EAAIQ,SAAS3B,EAAKiB,MAAMpB,EAAIyB,EAAQtB,EAAKiB,MAAMnB,EAAIyB,EAAQD,EAAQC,EACrE,CAEA,SAASK,IACP,GAAI3B,EAASgB,MAAO,OACpB,MAAMY,EAAO,IAAKjC,EAAMqB,MAAM,IAO9B,GANwB,UAApBlB,EAAUkB,MAAmBY,EAAKhC,IACT,SAApBE,EAAUkB,MAAkBY,EAAKhC,IACb,OAApBE,EAAUkB,MAAgBY,EAAK/B,IACX,SAApBC,EAAUkB,OAAkBY,EAAK/B,IAIxC+B,EAAKhC,EAAI,GAAKgC,EAAKhC,GAAKJ,GACxBoC,EAAK/B,EAAI,GAAK+B,EAAK/B,GAAKJ,GACxBE,EAAMqB,MAAMa,MAAKJ,GAAOA,EAAI7B,IAAMgC,EAAKhC,GAAK6B,EAAI5B,IAAM+B,EAAK/B,IAI3D,OAFAG,EAASgB,OAAQ,OACjBc,cAAc7B,GAIhBN,EAAMqB,MAAMe,QAAQH,GAEhBA,EAAKhC,IAAMG,EAAKiB,MAAMpB,GAAKgC,EAAK/B,IAAME,EAAKiB,MAAMnB,GACnDZ,EAAM+B,QACNgB,KAEArC,EAAMqB,MAAMiB,MAEdhB,GACF,CAEA,SAASe,IACP,IAAIE,EACJ,GACEA,EAAU,CACRtC,EAAGgB,KAAKuB,MAAMvB,KAAKwB,SAAW5C,GAC9BK,EAAGe,KAAKuB,MAAMvB,KAAKwB,SAAW3C,UAEzBE,EAAMqB,MAAMa,MAAKJ,GAAOA,EAAI7B,IAAMsC,EAAQtC,GAAK6B,EAAI5B,IAAMqC,EAAQrC,KAC1EE,EAAKiB,MAAQkB,CACf,CAEA,SAASG,EAAQC,GACD,YAAVA,EAAEC,KAAyC,SAApBzC,EAAUkB,MAAkBlB,EAAUkB,MAAQ,KACtD,cAAVsB,EAAEC,KAA2C,OAApBzC,EAAUkB,MAAgBlB,EAAUkB,MAAQ,OAC3D,cAAVsB,EAAEC,KAA2C,UAApBzC,EAAUkB,MAAmBlB,EAAUkB,MAAQ,OAC9D,eAAVsB,EAAEC,KAA4C,SAApBzC,EAAUkB,QAAkBlB,EAAUkB,MAAQ,QACnF,CAGA,IAAIwB,EAAc,EACdC,EAAc,EAClB,SAASC,EAAiBJ,GACC,IAArBA,EAAEK,QAAQC,SACZJ,EAAcF,EAAEK,QAAQ,GAAGE,QAC3BJ,EAAcH,EAAEK,QAAQ,GAAGG,QAE/B,CACA,SAASC,EAAeT,GACtB,GAAgC,IAA5BA,EAAEU,eAAeJ,OAAc,CACjC,MAAMK,EAAKX,EAAEU,eAAe,GAAGH,QAAUL,EACnCU,EAAKZ,EAAEU,eAAe,GAAGF,QAAUL,EACrC7B,KAAKuC,IAAIF,GAAMrC,KAAKuC,IAAID,GACtBD,EAAK,IAA0B,SAApBnD,EAAUkB,MAAkBlB,EAAUkB,MAAQ,QACpDiC,GAAM,IAA0B,UAApBnD,EAAUkB,QAAmBlB,EAAUkB,MAAQ,QAEhEkC,EAAK,IAA0B,OAApBpD,EAAUkB,MAAgBlB,EAAUkB,MAAQ,OAClDkC,GAAM,IAA0B,SAApBpD,EAAUkB,QAAkBlB,EAAUkB,MAAQ,KAEvE,CACF,CAEA,SAAS7B,IACPQ,EAAMqB,MAAQ,CAAC,CAAEpB,EAAG,EAAGC,EAAG,IAC1BC,EAAUkB,MAAQ,QAClB/B,EAAM+B,MAAQ,EACdhB,EAASgB,OAAQ,EACjBgB,IACAf,IACAhB,EAAQmD,YAAYzB,EAAM,IAC5B,C,OAEA,IAAA0B,YAAU,KACR3C,IACAO,IACAH,OAAOwC,iBAAiB,SAAU5C,GAClCI,OAAOwC,iBAAiB,UAAWjB,GAEnC3C,EAAOsB,MAAMsC,iBAAiB,aAAcZ,EAAkB,CAAEa,SAAS,IACzE7D,EAAOsB,MAAMsC,iBAAiB,WAAYP,EAAgB,CAAEQ,SAAS,IACrEtD,EAAQmD,YAAYzB,EAAM,IAAI,KAGhC,IAAA6B,cAAY,KACV1C,OAAO2C,oBAAoB,SAAU/C,GACrCI,OAAO2C,oBAAoB,UAAWpB,GAClC3C,EAAOsB,QACTtB,EAAOsB,MAAMyC,oBAAoB,aAAcf,GAC/ChD,EAAOsB,MAAMyC,oBAAoB,WAAYV,IAE/CjB,cAAc7B,EAAM,I,4RClKsH,I,UCQxIyD,GAAY,OACd,EACAxF,EACAmB,GACA,EACA,KACA,WACA,MAIF,EAAeqE,EAAiB,O","sources":["webpack://vue-beginner/./src/views/Snake.vue?05df","webpack://vue-beginner/Snake.vue","webpack://vue-beginner/./src/views/Snake.vue?ab0d","webpack://vue-beginner/./src/views/Snake.vue"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('div',{staticClass:\"snake-game\"},[_c('canvas',{ref:\"canvas\",style:(_setup.canvasStyle),attrs:{\"width\":_setup.canvasWidth,\"height\":_setup.canvasHeight}}),(_setup.gameOver)?_c('div',{staticClass:\"game-over\"},[_vm._v(\" 游戏结束！分数：\"+_vm._s(_setup.score)+\" \"),_c('button',{on:{\"click\":_setup.restart}},[_vm._v(\"重新开始\")])]):_vm._e()])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"snake-game\">\r\n    <canvas ref=\"canvas\" :width=\"canvasWidth\" :height=\"canvasHeight\" :style=\"canvasStyle\" />\r\n    <div v-if=\"gameOver\" class=\"game-over\">\r\n      游戏结束！分数：{{ score }}\r\n      <button @click=\"restart\">重新开始</button>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted, onUnmounted, computed } from 'vue';\r\n\r\n// 响应式 canvas 尺寸\r\nconst baseSize = 400;\r\nconst cellSize = 20;\r\nconst cols = baseSize / cellSize;\r\nconst rows = baseSize / cellSize;\r\n\r\nconst canvas = ref(null);\r\nconst snake = ref([\r\n  { x: 5, y: 5 },\r\n]);\r\nconst direction = ref('right');\r\nconst food = ref({ x: 10, y: 10 });\r\nconst gameOver = ref(false);\r\nconst score = ref(0);\r\nlet timer = null;\r\n\r\n// 适配移动端，canvas 宽高自适应\r\nconst canvasWidth = ref(baseSize);\r\nconst canvasHeight = ref(baseSize);\r\nconst canvasStyle = computed(() => ({\r\n  width: '100%',\r\n  height: 'auto',\r\n  maxWidth: '100vw',\r\n  maxHeight: '100vw',\r\n  display: 'block',\r\n  touchAction: 'none',\r\n}));\r\n\r\nfunction updateCanvasSize() {\r\n  // 以屏幕宽度为准，最大 400px\r\n  const size = Math.min(window.innerWidth, 400);\r\n  canvasWidth.value = size;\r\n  canvasHeight.value = size;\r\n}\r\n\r\nfunction draw() {\r\n  const ctx = canvas.value.getContext('2d');\r\n  ctx.clearRect(0, 0, canvasWidth.value, canvasHeight.value);\r\n  const scaleX = canvasWidth.value / cols;\r\n  const scaleY = canvasHeight.value / rows;\r\n  // 画蛇\r\n  ctx.fillStyle = 'green';\r\n  snake.value.forEach(seg => {\r\n    ctx.fillRect(seg.x * scaleX, seg.y * scaleY, scaleX, scaleY);\r\n  });\r\n  // 画食物\r\n  ctx.fillStyle = 'red';\r\n  ctx.fillRect(food.value.x * scaleX, food.value.y * scaleY, scaleX, scaleY);\r\n}\r\n\r\nfunction move() {\r\n  if (gameOver.value) return;\r\n  const head = { ...snake.value[0] };\r\n  if (direction.value === 'right') head.x++;\r\n  else if (direction.value === 'left') head.x--;\r\n  else if (direction.value === 'up') head.y--;\r\n  else if (direction.value === 'down') head.y++;\r\n\r\n  // 撞墙或撞自己\r\n  if (\r\n    head.x < 0 || head.x >= cols ||\r\n    head.y < 0 || head.y >= rows ||\r\n    snake.value.some(seg => seg.x === head.x && seg.y === head.y)\r\n  ) {\r\n    gameOver.value = true;\r\n    clearInterval(timer);\r\n    return;\r\n  }\r\n\r\n  snake.value.unshift(head);\r\n  // 吃到食物\r\n  if (head.x === food.value.x && head.y === food.value.y) {\r\n    score.value++;\r\n    placeFood();\r\n  } else {\r\n    snake.value.pop();\r\n  }\r\n  draw();\r\n}\r\n\r\nfunction placeFood() {\r\n  let newFood;\r\n  do {\r\n    newFood = {\r\n      x: Math.floor(Math.random() * cols),\r\n      y: Math.floor(Math.random() * rows),\r\n    };\r\n  } while (snake.value.some(seg => seg.x === newFood.x && seg.y === newFood.y));\r\n  food.value = newFood;\r\n}\r\n\r\nfunction keydown(e) {\r\n  if (e.key === 'ArrowUp' && direction.value !== 'down') direction.value = 'up';\r\n  else if (e.key === 'ArrowDown' && direction.value !== 'up') direction.value = 'down';\r\n  else if (e.key === 'ArrowLeft' && direction.value !== 'right') direction.value = 'left';\r\n  else if (e.key === 'ArrowRight' && direction.value !== 'left') direction.value = 'right';\r\n}\r\n\r\n// 触摸滑动支持\r\nlet touchStartX = 0;\r\nlet touchStartY = 0;\r\nfunction handleTouchStart(e) {\r\n  if (e.touches.length === 1) {\r\n    touchStartX = e.touches[0].clientX;\r\n    touchStartY = e.touches[0].clientY;\r\n  }\r\n}\r\nfunction handleTouchEnd(e) {\r\n  if (e.changedTouches.length === 1) {\r\n    const dx = e.changedTouches[0].clientX - touchStartX;\r\n    const dy = e.changedTouches[0].clientY - touchStartY;\r\n    if (Math.abs(dx) > Math.abs(dy)) {\r\n      if (dx > 20 && direction.value !== 'left') direction.value = 'right';\r\n      else if (dx < -20 && direction.value !== 'right') direction.value = 'left';\r\n    } else {\r\n      if (dy > 20 && direction.value !== 'up') direction.value = 'down';\r\n      else if (dy < -20 && direction.value !== 'down') direction.value = 'up';\r\n    }\r\n  }\r\n}\r\n\r\nfunction restart() {\r\n  snake.value = [{ x: 5, y: 5 }];\r\n  direction.value = 'right';\r\n  score.value = 0;\r\n  gameOver.value = false;\r\n  placeFood();\r\n  draw();\r\n  timer = setInterval(move, 120);\r\n}\r\n\r\nonMounted(() => {\r\n  updateCanvasSize();\r\n  draw();\r\n  window.addEventListener('resize', updateCanvasSize);\r\n  window.addEventListener('keydown', keydown);\r\n  // 触摸事件\r\n  canvas.value.addEventListener('touchstart', handleTouchStart, { passive: false });\r\n  canvas.value.addEventListener('touchend', handleTouchEnd, { passive: false });\r\n  timer = setInterval(move, 120);\r\n});\r\n\r\nonUnmounted(() => {\r\n  window.removeEventListener('resize', updateCanvasSize);\r\n  window.removeEventListener('keydown', keydown);\r\n  if (canvas.value) {\r\n    canvas.value.removeEventListener('touchstart', handleTouchStart);\r\n    canvas.value.removeEventListener('touchend', handleTouchEnd);\r\n  }\r\n  clearInterval(timer);\r\n});\r\n</script>\r\n\r\n<style scoped>\r\n.snake-game {\r\n  position: relative;\r\n  width: 100vw;\r\n  max-width: 400px;\r\n  margin: 0 auto;\r\n  padding-top: 10vw;\r\n  box-sizing: border-box;\r\n}\r\ncanvas {\r\n  border: 1px solid #333;\r\n  background: #fafafa;\r\n  width: 100%;\r\n  height: auto;\r\n  display: block;\r\n  touch-action: none;\r\n}\r\n.game-over {\r\n  position: absolute;\r\n  top: 40%;\r\n  left: 0;\r\n  width: 100%;\r\n  text-align: center;\r\n  background: rgba(255,255,255,0.8);\r\n  font-size: 1.2rem;\r\n  padding: 1.2rem 0;\r\n}\r\nbutton {\r\n  font-size: 1rem;\r\n  padding: 0.6rem 1.2rem;\r\n  margin-top: 1rem;\r\n  border-radius: 0.5rem;\r\n  border: none;\r\n  background: #4caf50;\r\n  color: #fff;\r\n  box-shadow: 0 2px 6px rgba(0,0,0,0.1);\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Snake.vue?vue&type=script&setup=true&lang=js\"; export default mod; export * from \"-!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Snake.vue?vue&type=script&setup=true&lang=js\"","import { render, staticRenderFns } from \"./Snake.vue?vue&type=template&id=5e19871b&scoped=true\"\nimport script from \"./Snake.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./Snake.vue?vue&type=script&setup=true&lang=js\"\nimport style0 from \"./Snake.vue?vue&type=style&index=0&id=5e19871b&prod&scoped=true&lang=css\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"5e19871b\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","_setup","_setupProxy","staticClass","ref","style","attrs","canvasWidth","canvasHeight","_v","_s","score","on","restart","_e","staticRenderFns","baseSize","cellSize","cols","rows","canvas","snake","x","y","direction","food","gameOver","timer","canvasStyle","computed","width","height","maxWidth","maxHeight","display","touchAction","updateCanvasSize","size","Math","min","window","innerWidth","value","draw","ctx","getContext","clearRect","scaleX","scaleY","fillStyle","forEach","seg","fillRect","move","head","some","clearInterval","unshift","placeFood","pop","newFood","floor","random","keydown","e","key","touchStartX","touchStartY","handleTouchStart","touches","length","clientX","clientY","handleTouchEnd","changedTouches","dx","dy","abs","setInterval","onMounted","addEventListener","passive","onUnmounted","removeEventListener","component"],"sourceRoot":""}